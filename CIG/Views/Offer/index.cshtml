@{
    ViewData["Title"] = "Crea Offerta PDF";
}
<link rel="stylesheet" href="~/css/offer.css" />
<script type="module" src="js/offer.js"></script>

<hr />  

<div id="stepsContainer">
    <!-- STEP 1: Scelta Auto -->
    <div id="step1" class="step-content active">
        <div class="car-selection-container">
            <div class="dropdowns">
                <select id="marca"></select>
                <select id="modello"></select>
                <select id="versione"></select>
                <select id="variante"></select>
            </div>
            <div class="car-preview">
                <img id="anteprimaAuto" src="" alt="Anteprima Auto">
                <div id="imagePlaceholder">Seleziona una variante per visualizzare l'anteprima</div>
               
            </div>
            <!-- NUOVI CAMPI: Descrizione Versione e Note -->
            <div class="additional-car-info" style="margin-top: 20px;">
                <div class="form-group">
                    <label for="descrizioneVersione">Descrizione versione:</label>
                    <input type="text" id="descrizioneVersione" placeholder="Inserisci descrizione versione" required>
                </div>
       
            </div>
            <div class="form-group">
                <label for="noteAuto">Note:</label>
                <textarea id="noteAuto" placeholder="Inserisci eventuali note sull'auto"></textarea>
            </div>
        </div>
    </div>

    <!-- STEP 2: Scelta Cliente (NUOVO STEP) -->
    <div id="step2" class="step-content" style="display:none;">
        <h2>Seleziona Cliente</h2>
        <div style="margin-top:20px;">
            <input type="text" id="customerInput" placeholder="Cerca cliente..." autocomplete="off" />
            <ul id="customerResults" style="border:1px solid #ccc;padding:5px;max-height:200px;overflow:auto;display:none;"></ul>
        </div>
        <div style="margin-top:30px;">
            <table id="customerTable" class="table">
                <thead>
                    <tr>
                        <th>Nome</th>
                        <th>Cognome / Ragione Sociale</th>
                        <th>Email</th>
                        <th>Telefono</th>
                    </tr>
                </thead>
                <tbody id="customerTableBody">
                    <!-- i clienti verranno inseriti qui da JavaScript -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- STEP 3: Scelta servizi -->
    <div id="step3" class="step-content" style="display:none;">
        <div id="servicesSection">
            <h2>Scegli i servizi per l'offerta:</h2>
            <div id="servicesList">Caricamento servizi...</div>
        </div>
    </div>

    <!-- STEP 4: Dati Economici -->
    <div id="step4" class="step-content" style="display:none;">
        <h2>Dati Economici Offerta</h2>
        <div class="economic-data-form">
            <div class="form-group">
                <label for="durataMesi">Durata (mesi):</label>
                <input type="number" id="durataMesi" placeholder="es. 36">
            </div>
            <div class="form-group">
                <label for="kmTotali">Km totali previsti:</label>
                <input type="number" id="kmTotali" placeholder="es. 60000">
            </div>
            <div class="form-group">
                <label for="anticipo">Anticipo (€):</label>
                <input type="number" id="anticipo" placeholder="es. 1000">
            </div>
            <div class="form-group">
                <label for="canone">Canone Mensile (€):</label>
                <input type="number" id="canone" placeholder="es. 350">
            </div>
        </div>
    </div>

    <!-- STEP 5: Riepilogo e Conferma -->
    <div id="step5" class="step-content" style="display:none;">
        <h2>Riepilogo Offerta</h2>
        <div id="riepilogoOfferta" class="summary-container">
            <!-- Riepilogo generato via JS -->
        </div>
        
    </div>
</div>

<!-- Bottoni navigazione STEP -->
<div class="navigation-buttons">
    <button id="backBtn" style="display:none;">← Indietro</button>
    <button id="nextStepBtn">Step 2 →</button>
    <button id="generatePdfBtn" style="display:none; margin-top:10px;">Ottieni PDF</button>
</div>

<button id="generatePdfBtn" style="display:none; margin-top:10px;">Ottieni PDF</button>
<div id="pdfLoader" style="display:none; margin-top:10px;">
    <span>Generazione PDF in corso...</span>
    <div class="loader"></div>
</div>

<div id="pdfLoader" style="display:none;">
    <div class="loader"></div>
</div>
<div id="loader" style="display:none;">
    <div class="image-loader"></div>
</div>
